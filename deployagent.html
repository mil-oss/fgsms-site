<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 11 Mar 2017 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20170311" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Fine Grained Service Monitoring System &#x2013; Installation Procedures FGSMS Agents</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
                      <a href="https://github.com/mil-oss/fgsms">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><a href="http://mil-oss.org/" id="bannerLeft"><img src="images/mil-oss-logo.png"  alt="Fine Grained Service Monitoring System"/></a></div>
        <div class="pull-right"><div id="bannerRight"><img src="images/fgsms_logo_small.png" /></div>
</div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="projectVersion">Version: 7.0.0<span class="divider">|</span></li>
        <li class=""><a href="https://www.mil-oss.org" class="externalLink" title="MIL-OSS">MIL-OSS</a><span class="divider">/</span></li>
    <li class="active ">Installation Procedures FGSMS Agents</li>
        <li id="publishDate" class="pull-right">Last Published: 11 Mar 2017</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
      <li><a href="index.html" title="Project Information"><span class="none"></span>Project Information</a>  </li>
    <li><a href="index2.html" title="Welcome"><span class="none"></span>Welcome</a>  </li>
    <li><a href="whitepaper.html" title="Whitepaper"><span class="none"></span>Whitepaper</a>  </li>
    <li><a href="architecture.html" title="Architecture"><span class="none"></span>Architecture</a>  </li>
    <li><a href="quickstart.html" title="Quick Start"><span class="none"></span>Quick Start</a>  </li>
    <li><a href="deployment-planning.html" title="Deployment Planning"><span class="none"></span>Deployment Planning</a>  </li>
    <li><a href="deployserver.html" title="Deploying the Server"><span class="none"></span>Deploying the Server</a>  </li>
    <li><a href="agentmatrix.html" title="Agent Matrix"><span class="none"></span>Agent Matrix</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>Deploying Agents</a>
  </li>
    <li><a href="user.html" title="User Guide"><span class="none"></span>User Guide</a>  </li>
    <li><a href="reporting.html" title="Reports and data access"><span class="none"></span>Reports and data access</a>  </li>
    <li><a href="security.html" title="Security Guide"><span class="none"></span>Security Guide</a>  </li>
    <li><a href="permissions.html" title="Access Control"><span class="none"></span>Access Control</a>  </li>
    <li><a href="federation.html" title="Data Federation"><span class="none"></span>Data Federation</a>  </li>
    <li><a href="news.html" title="News"><span class="none"></span>News</a>  </li>
    <li><a href="sdk.html" title="SDK"><span class="none"></span>SDK</a>  </li>
    <li><a href="specs.html" title="Specs/ICD"><span class="none"></span>Specs/ICD</a>  </li>
    <li><a href="committer.html" title="Committers"><span class="none"></span>Committers</a>  </li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a>  </li>
            <li class="nav-header">Modules</li>
    <li><a href="apache-tomcat/index.html" title="Pre-Configured Apache Tomcat"><span class="none"></span>Pre-Configured Apache Tomcat</a>  </li>
    <li><a href="apache-juddi/index.html" title="Pre-Configured Apache Juddi"><span class="none"></span>Pre-Configured Apache Juddi</a>  </li>
    <li><a href="fgsms-common-interfaces/index.html" title="fgsms Interfaces WS Stubs and Schema Bindings Generated from WSDL"><span class="none"></span>fgsms Interfaces WS Stubs and Schema Bindings Generated from WSDL</a>  </li>
    <li><a href="fgsms-common/index.html" title="fgsms Common"><span class="none"></span>fgsms Common</a>  </li>
    <li><a href="fgsms-agents/index.html" title="fgsms Embedded Agents"><span class="none"></span>fgsms Embedded Agents</a>  </li>
    <li><a href="fgsms-ws-notification/index.html" title="fgsms WS-Notification Parent"><span class="none"></span>fgsms WS-Notification Parent</a>  </li>
    <li><a href="fgsms-server/index.html" title="fgsms Server"><span class="none"></span>fgsms Server</a>  </li>
    <li><a href="fgsms-cli/index.html" title="fgsms Command Line Interface"><span class="none"></span>fgsms Command Line Interface</a>  </li>
    <li><a href="fgsms-samples/index.html" title="fgsms Examples Packages"><span class="none"></span>fgsms Examples Packages</a>  </li>
    <li><a href="fgsms-dist/index.html" title="fgsms Distribution"><span class="none"></span>fgsms Distribution</a>  </li>
    <li><a href="fgsms-netagent/index.html" title="fgsms.Net Components"><span class="none"></span>fgsms.Net Components</a>  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a>  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
<form id="search-form" action="https://www.google.com/search" method="get" >
      <input value="https://mil-oss.github.io/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript">asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Installation Procedures FGSMS Agents</h1>
<p>Note: this article is dated and needs many updates.</p>
<p>We&#x2019;re currently working on an automagical installation wizard to automate most of the stuff in this article. The info here is mostly useful as a a reference guide.</p>
<h1>Java Web Service Agents</h1>
<p>Agents are broken into both CLIENT and SERVICE agents. Only configure the agent that is needed to monitor a specific service. Client and service agents may be combined. Currently the behavior is that each time a message is witnessed, it will be recorded by each agent.</p>
<h1>Java Agents</h1>
<p>From the distribution package, locate the agents folder. Edit the file in fgsms-agent.properties Modify the required settings Save and close the file</p>
<div class="section">
<h2><a name="Configuration_Parameters"></a>Configuration Parameters</h2>
<p>For the latest documentation view the inline comments within the example fgsms-agent.properties within FGSMS.AgentCore.jar.</p>
<p>This section is for Java based FGSMS Web Service (Transactional) Agents only.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>Property </th>
      
<th>Values </th>
      
<th>Description</th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>FGSMS.AuthMode </td>
      
<td>None, PKI, UsernamePassword </td>
      
<td>The authentication mode to the fgsms server.</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.AuthMode.Username </td>
      
<td>string</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.AuthMode.Password </td>
      
<td>string </td>
      
<td>Encrypted password. It can be encrypted with <tt>java -jar fgsms.Common-XXX-with-dependencies.jar</tt></td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.AuthMode.PKICert </td>
      
<td>Not yet implemented</td>
    </tr>
    
<tr class="b">
      
<td>message.processor.ignoreList </td>
      
<td>string|string|&#x2026;. </td>
      
<td>delimited URLs to be ignored delimited by the pipe symbol</td>
    </tr>
    
<tr class="a">
      
<td>datacollectorservice.URL </td>
      
<td>url1|url2|&#x2026;. Execution URL to an instance of FGSMS DCS Service. Multiple values delimited by |</td>
    </tr>
    
<tr class="b">
      
<td>datacollectorservice.algorithm </td>
      
<td>fallback, roundrobin </td>
      
<td>&#x201c;Fallback = try the URLs in order until one works. Roundrobin = iteratively loop through the list, distributing the load evenly. If one fails, try the next one until we succeed.&#x201d;</td>
    </tr>
    
<tr class="a">
      
<td>datacollectorservice.retry &gt;= 0</td>
    </tr>
    
<tr class="b">
      
<td>policyconfigurationservice.URL </td>
      
<td>url1|url2|&#x2026;. </td>
      
<td>Execution URL to an instance of FGSMS PCS Service. Multiple values delimited by |</td>
    </tr>
    
<tr class="a">
      
<td>policyconfigurationservice.algorithm </td>
      
<td>fallback, roundrobin </td>
      
<td>&#x201c;Fallback = try the URLs in order until one works. Roundrobin = iteratively loop through the list, distributing the load evenly. If one fails, try the next one until we succeed.&#x201d;</td>
    </tr>
    
<tr class="b">
      
<td>policyconfigurationservice.retry </td>
      
<td>&gt;= 0</td>
    </tr>
    
<tr class="a">
      
<td>discovery.interval </td>
      
<td>30000 </td>
      
<td>if enabled, a list of URLs will be periodically loaded and dynamically ADDED to the list of above for each service. Time in milliseconds</td>
    </tr>
    
<tr class="b">
      
<td>discovery.uddi.enabled </td>
      
<td>True/false</td>
    </tr>
    
<tr class="a">
      
<td>discovery.uddi.inquiry.url </td>
      
<td>Optional, execution URL, overrides the WSDL location.</td>
    </tr>
    
<tr class="b">
      
<td>discovery.uddi.inquiry.authrequired </td>
      
<td>true/false </td>
      
<td>Some UDDI servers allow for anonymous Inquires.</td>
    </tr>
    
<tr class="a">
      
<td>discovery.uddi.inquiry.authmode </td>
      
<td>http or uddi </td>
      
<td>&#x201c;UDDI = Use the security endpoint for authentication. HTTP = Use HTTP style authentication&#x201d;</td>
    </tr>
    
<tr class="b">
      
<td>discovery.uddi.security.url </td>
      
<td>Optional, execution URL, overrides the WSDL location.</td>
    </tr>
    
<tr class="a">
      
<td>discovery.uddi.security.username </td>
      
<td>string </td>
    </tr>
    
<tr class="b">
      
<td>discovery.uddi.security.password </td>
      
<td>Encrypted password </td>
    </tr>
    
<tr class="a">
      
<td>discovery.uddi.lookup.findType </td>
      
<td>EndpointBindingKey, EndpointKeyWord, BusinessService </td>
      
<td>&#x201c;EndpointBindingKey, loads from a BindingTemplate Key, this must be the unique identifier for the binding template containing 0 or more endpoints. EndpointKeyWord , attempts to find services by name, aka the display name. ServiceEntityKey loads from a BusinessService key, this must be the unique identifier for the business service containing 0 or more binding templates with 0 or more endpoints&#x201d;</td>
    </tr>
    
<tr class="b">
      
<td>discovery.uddi.lookup.dcs.servicename </td>
      
<td>string </td>
      
<td>Based on the findType, the value that we are looking for, see above.</td>
    </tr>
    
<tr class="a">
      
<td>discovery.uddi.lookup.pcs.servicename </td>
      
<td>string </td>
      
<td>Based on the findType, the value that we are looking for, see above.</td>
    </tr>
    
<tr class="b">
      
<td>message.processor.dead.message.queue.duration </td>
      
<td>number &gt;= 10000 </td>
      
<td>Default = 600000&#x201c; Time in ms in which a message is declared dead. This occurs when an request comes in, but a response is not returned | agent.dependencyinjection.enabled | true/false | Enables/Disables the insertion of headers into messages to track and correlate service chaining events. | agent.unavailablebehavior | PURGE, HOLD, HOLDPERSIST | &#x201d;PURGE= purge the queues and drop all messages until PCS/DCS is available, then resume normal operations. HOLD= hang on to the data until PCS/DCS is available again, if this container goes down, data still in the queue will be lost. HOLDPERSIST = hang on to the data until PCS/DCS is available again, if this container goes down, data will be stored in a temp file&quot;</td>
    </tr>
    
<tr class="a">
      
<td>agent.offlinestorage </td>
      
<td>[path] </td>
      
<td>Used as the Persistent storage location for metrics/message logs.</td>
    </tr>
  </tbody>
</table></div>
<div class="section">
<h2><a name="Adding_the_Agent_to_your_Java_classpath"></a>Adding the Agent to your Java classpath</h2>
<p>If you happen to have the source code to the component you&#x2019;re monitoring and you&#x2019;re using maven or gradle to build the system, then you just simply need to the appropriate agent as a dependency, add your config file and go.</p>
<p>From the distribution zip, you&#x2019;ll need fgsms.AgentCore-(version)-with-dependencies.jar and one of the following jars that are specific to your application.</p></div>
<div class="section">
<h2><a name="JbossWS_JAX-WS_Service_AgentFGSMS.JbossWSJAXWSAgent.jar"></a>JbossWS JAX-WS Service Agent(FGSMS.JbossWSJAXWSAgent.jar)</h2>
<p>The installation of JbossWS agents depends on what version of JbossWS you are using. By default Jboss AS 4.2.3 comes with JbossWS-Native 2.0, which is incompatible with FGSMS. JbossWS Native 3.1.1 should be used instead. If using JbossWS Native 3.1.1, things are much easier as it supports a global standard-endpoint-config.xml file. This file is located within the jbossws.sar/META-INF folder.</p>
<p>Later versions of Jboss AS use JbossWS variants which do NOT support globally defined handlers within jbossws.sar. In this case, start with the default standard-endpoint-config.xml, add the FGSMS values below, and then copy the standard-endpoint-config.xml file into the /META-INF folder of each service to needs to be monitored.</p>
<p>Edit the file within server\default\deploy\jbossws.sar\META-INF\standard-jaxws-endpoint-config.xml</p>
<p>Add the remarked sections below to the standard-endpoint-config.xml file.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">  &lt;endpoint-config&gt;
    &lt;config-name&gt;Standard Endpoint&lt;/config-name&gt;
    &lt;pre-handler-chains&gt;
      &lt;javaee:handler-chain&gt;
        &lt;javaee:protocol-bindings&gt;##SOAP11_HTTP&lt;/javaee:protocol-bindings&gt;
&lt;!-- insert FGSMS handler here --&gt;
		&lt;javaee:handler&gt;
          &lt;javaee:handler-name&gt;FGSMS Agent&lt;/javaee:handler-name&gt;
          &lt;javaee:handler-class&gt;org.miloss.fgsms.agents.JbossWSMonitor&lt;/javaee:handler-class&gt;
        &lt;/javaee:handler&gt;
&lt;!-- insert FGSMS handler here --&gt;
      &lt;/javaee:handler-chain&gt;
    &lt;/pre-handler-chains&gt;
  &lt;/endpoint-config&gt;
</pre></div></div>
<p>Restart Jboss and perform some action that calls a web service within the container. You should see some output in the standard Jboss server.log related to FGSMS. Only services based on JAX-WS using the default class loader will be monitored. Any web application that uses another class loader or has JbossWS embedded into the WAR or EAR file will not automatically be monitored. Follow the same procedure as above to monitor them.</p></div>
<div class="section">
<h2><a name="JbossWS_JAX-WS_Client_AgentFGSMS.JbossWSJAXWSAgent.jar"></a>JbossWS JAX-WS Client Agent(FGSMS.JbossWSJAXWSAgent.jar)</h2>
<p>The installation of JbossWS agents depends on what version of JbossWS you are using. By default Jboss AS 4 comes with JbossWS-Native 2.0, which is incompatible with FGSMS. JbossWS Native 3.1.1 should be used instead. If using JbossWS Native 3.1.1, things are much easier as it supports a global standard-endpoint-config.xml file. This file is located within the jbossws.sar/META-INF folder.</p>
<p>Later version of Jboss AS use different variants which do NOT support globally defined handlers. In this instance, start with the default file, add the FGSMS values, and copy the standard-endpoint-config.xml file into the /META-INF folder of the service to monitored.</p>
<p>Edit the file within server\default\deploy\jbossws.sar\META-INF\standard-jaxws-client-config.xml</p>
<p>Add the remarked sections below to the standard-client-config.xml file.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">  &lt;client-config&gt;
    &lt;config-name&gt;Standard Client&lt;/config-name&gt;
	&lt;post-handler-chains&gt;
      &lt;javaee:handler-chain&gt;
		 &lt;javaee:handler&gt;
			 &lt;javaee:handler-name&gt;FGSMS Handler&lt;/javaee:handler-name&gt;
			  &lt;javaee:handler-class&gt;org.miloss.fgsms.agents.JbossWSClientAgent&lt;/javaee:handler-class&gt;
			&lt;/javaee:handler&gt;
		 &lt;/javaee:handler-chain&gt;
    &lt;/post-handler-chains&gt;
    &lt;feature&gt;http://org.jboss.ws/dispatch/validate&lt;/feature&gt;	
  &lt;/client-config&gt;
</pre></div></div>
<p>Restart Jboss and perform some action that calls a web service within the container. You should see some output in the standard Jboss server.log related to FGSMS. Only services based on JAX-WS using the default class loader will be monitored. Any web application that uses another class loader or has JbossWS embedded into the WAR or EAR file will not automatically be monitored. Follow the same procedure as above to monitor them.</p></div>
<div class="section">
<h2><a name="Axis_1.3_Client_and_Service_Agent_FGSMS.Axis1xAgent.jar"></a>Axis 1.3+ Client and Service Agent (FGSMS.Axis1xAgent.jar)</h2>
<p>Copy the following files into the server/default/lib folder</p>
<p>Modify the web application containing the service that you wish to monitor server/default/deploy/warfile.war/ WEB-INF/server-config.wsdd to include the following</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">&lt;requestFlow&gt;
	&lt;handler name=&quot;FGSM&quot;	type=&quot;java:org.miloss.fgsms.agents.Axis1MonitorInbound&quot;&gt;
	&lt;/handler&gt;
&lt;/requestFlow&gt;
&lt;responseFlow&gt;
		&lt;handler name=&quot;FGSM&quot; type=&quot;java:org.miloss.fgsms.agents.Axis1MonitorOutbound&quot;&gt;
	&lt;/handler&gt;
&lt;/responseFlow&gt;
</pre></div></div>
<p>As an additional dependency, the JbossWS framework or some other kind of JAXWS framework should also be present within this container/deployment. You may have to experiment depending on the version of Jboss in use.</p></div>
<div class="section">
<h2><a name="Axis_2.x_Metro_Apache_CXF_FGSMS.GenericJAXWSAgent.jar"></a>Axis 2.x, Metro, Apache CXF (FGSMS.GenericJAXWSAgent.jar)</h2>
<p>Axis 2.x is based on JAX-WS, therefore the same files and procedures hold true for JbossWS JAX-WS. The only difference is that standard-jaxws-endpoint-config.xml is NOT modified, only the server-config.wsdd is modified to include the class org.miloss.fgsms.agent.JAXWSGenericAgent (for services) and org.miloss.fgsms.agent.JAXWSGenericClientAgent (for clients) into the handler chain.</p>
<p>Metro: Within Jboss and the use of JbossWS, use the JbossWS handler, otherwise use the JAXWS Generic Agent classpath within the sun-jaxws.xml config file.</p>
<p>The correct classpath is Service: org.miloss.fgsms.agents.JAXWSGenericAgent Client: org.miloss.fgsms.agents.JAXWSGenericClientAgent The following is an example taken from jUDDI. The parts in bold font are the changes.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">&lt;bean id=&quot;FGSM&quot; class=&quot;org.miloss.fgsms.agents.JAXWSGenericAgent&quot; /&gt;
  &lt;jaxws:endpoint id=&quot;inquiry&quot; implementor=&quot;org.apache.juddi.api.impl.UDDIInquiryImpl&quot; address=&quot;/inquiry&quot;&gt;
    &lt;jaxws:properties&gt;
      &lt;entry key=&quot;schema-validation-enabled&quot; value=&quot;true&quot;/&gt;
    &lt;/jaxws:properties&gt;
    &lt;jaxws:handlers&gt;
      &lt;ref bean=&quot;FGSM&quot; /&gt;
    &lt;/jaxws:handlers&gt;
  &lt;/jaxws:endpoint&gt;
</pre></div></div></div>
<div class="section">
<h2><a name="Apache_CXF_Interceptors_FGSMS.ApacheCXFAgent.jar"></a>Apache CXF Interceptors (FGSMS.ApacheCXFAgent.jar)</h2>
<p>Edit beans.xml or cxf.xml and modify as necessary. The correct classpaths are</p>

<ul>
  
<li>org.miloss.fgsms.agents.CXFInterceptorOutClient</li>
  
<li>org.miloss.fgsms.agents.CXFInterceptorInClient</li>
  
<li>org.miloss.fgsms.agents.CXFInterceptorOutService</li>
  
<li>org.miloss.fgsms.agents.CXFInterceptorInService</li>
</ul></div>
<div class="section">
<h2><a name="JbossESB_FGSMS.JbossESBAgent.jar"></a>JbossESB (FGSMS.JbossESBAgent.jar)</h2>
<p>JbossESB allowed you to offer a while range of protocols and functionality within the ESB via a series of Action Pipeline Processors. These are defined within each .esb file within the jboss-esb.xml file. </p>
<p>The JbossESB FGSMS Action classes will enable the monitoring of a SOAP messages (and other stuff) that was sent to an ESB endpoint by inserting ActionPipeLineProcessor classes into the action chain. This can also be used to gauge the performance pretty much any ESB deployment, so long as a unique URL can be determined for that specific ESB deployment. </p>
<p>Copy the previously mention files into the <tt>server/default/lib</tt> folder along with FGSMS.JbossESBAgent.jar </p>
<p>Edit the <tt>jboss-esb.xml</tt> file within the ESB deployment to be monitored. Unfortunately this has to done on a per deployment basis and can&#x2019;t be deployed globally.</p>
<p>Insert the following before and after the proxied service is executed</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">	&lt;action name=&quot;FGSMBefore&quot;  
class=&quot;org.miloss.fgsms.agents.JbossESBProxyAction&quot;&gt;
		&lt;property name=&quot;http_port&quot; value=&quot;8080&quot; /&gt;
		&lt;property name=&quot;https_port&quot; value=&quot;7443&quot; /&gt;
	&lt;/action&gt;
	&lt;!-- do something here 
	&lt;action name=&quot;proxy&quot;&gt; snip &lt;/action&gt;
	--&gt;
&lt;!--
insert the following after the proxied service is executed.	--&gt;
	&lt;action name=&quot;FGSMAfter&quot;  class=&quot;org.miloss.fgsms.agents.JbossESBProxyAfterAction&quot;&gt;
		&lt;property name=&quot;http_port&quot; value=&quot;8080&quot; /&gt;
		&lt;property name=&quot;https_port&quot; value=&quot;7443&quot; /&gt;
	&lt;/action&gt;
</pre></div></div>
<p>The action attribute <tt>name</tt> is arbitrary but must be unique to each ESB deployment Fill out the property <tt>http(s)_port</tt> with ports that match the listening ports of your JbossESB container. JbossESB unfortunately doesn&#x2019;t offer a way to get the port information of the original inbound request, so we esscentially fabricate one on the fly. This is required so that A) The Bueller process can ping your endpoint and B) that the FGSMS web interface correctly displays the location of this deployment.</p>
<p>Restart Jboss and test. Upon the execution of something in JbossESB, logging output should be visible in the Jboss server.log file and once the service has been executed at least once, the endpoint should be listed within FGSM&#x2019;s Web GUI.</p></div>
<div class="section">
<h2><a name="Monitoring_Servlet_Based_Services_FGSMS.ServletFilterAgent.jar"></a>Monitoring Servlet Based Services (FGSMS.ServletFilterAgent.jar)</h2>
<p>In certain scenarios, web services can be implemented without using JAXWS and thus they cannot be monitored using web service handlers. If the service is implemented as a J2EE Servlet (3.0 spec or higher), then the FGSMS Servlet Filter can be used. </p>
<p>This is deployed by: Add the standard agent jar files along with FGSMS.ServletFilterAgent.jar within the classpath of the item that you wish to monitor. Modify the web.xml of the web application you wish to monitor. Use the following example to configure.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">&lt;filter&gt;
 &lt;filter-name&gt;FGSMFilter&lt;/filter-name&gt;
 &lt;filter-class&gt;org.miloss.fgsms.agents.HttpServletAgent&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
 &lt;filter-name&gt;FGSMFilter&lt;/filter-name&gt;
 &lt;url-pattern&gt;/hw&lt;/url-pattern&gt;
 &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
 &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
 &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
 &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
&lt;/filter-mapping&gt;
&lt;servlet&gt;
 &lt;servlet-name&gt;MyWebService&lt;/servlet-name&gt;
 &lt;servlet-class&gt;namespace.webservice.no2.HelloWorldPortImpl&lt;/servlet-class&gt;
&lt;/servlet&gt;
&lt;servlet-mapping&gt;
 &lt;servlet-name&gt; MyWebService &lt;/servlet-name&gt;
 &lt;url-pattern&gt;/hw&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</pre></div></div>
<p>The highlighted portions are used to trigger the filter when a request comes into the servlet &#x201c;MyWebService&#x201d;.</p>
<p>There are limitations of the Servlet Filter Agent, primarily, it cannot record request and response messages.</p></div>
<div class="section">
<h2><a name="Monitoring_JAX-WS_EJB_Services_with_JbossWS_3.4_or_higher"></a>Monitoring JAX-WS EJB Services with JbossWS 3.4 or higher</h2>
<p>JbossWS 3.4 or higher does not come with any predefined configuration for clients or services that are found in older versions as <tt>&#x201c;Standard-jaxws-client-config.xml&#x201d;</tt> and <tt>&#x201c;standard-jaxws-endpoint-config.xml&#x201d;</tt>. In older versions, these can be located within the path /server/default/deploy/jbossws.sar/META-INF file and can be used to set globally included handlers. You can copy those files into the above mentioned path.</p>
<p>For JbossWS 3.4, these files can also be created (a sample is included within the deployment package (in the \xml folder) for FGSM) in <tt>/server/default/deployers/jbossws.deployer/META-INF</tt></p>
<p>In case this doesn&#x2019;t work, the following are some alternative methods to monitor services.</p></div>
<div class="section">
<h2><a name="JbossWS-Native"></a>JbossWS-Native</h2>
<p>Within the service to be monitored deployment file (usually a .jar or .war file) there typically is a META-INF folder. If it does not exist, create it and then create a new file within it called standard-jaxws-endpoint-config.xml with the following text.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;jaxws-config xmlns=&quot;urn:jboss:jaxws-config:2.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:javaee=&quot;http://java.sun.com/xml/ns/javaee&quot;
  xsi:schemaLocation=&quot;urn:jboss:jaxws-config:2.0 schema/jaxws-config_2_0.xsd&quot;&gt;
    &lt;endpoint-config&gt;
    &lt;config-name&gt;Standard Endpoint&lt;/config-name&gt;
    &lt;pre-handler-chains&gt;
      &lt;javaee:handler-chain&gt;
        &lt;javaee:protocol-bindings&gt;##SOAP11_HTTP&lt;/javaee:protocol-bindings&gt;
  		&lt;javaee:handler&gt;
          &lt;javaee:handler-name&gt;FGSMS Agent JbossWSMonitor&lt;/javaee:handler-name&gt;
          &lt;javaee:handler-class&gt;org.miloss.fgsms.agents.JbossWSMonitor&lt;/javaee:handler-class&gt;
        &lt;/javaee:handler&gt;
      &lt;/javaee:handler-chain&gt;
  &lt;/pre-handler-chains&gt;
  &lt;/endpoint-config&gt;
  &lt;/jaxws-config&gt;
</pre></div></div></div>
<div class="section">
<h2><a name="JbossWS-CXF"></a>JbossWS-CXF</h2>
<p>Within the service to be monitored deployment file (usually a .jar or .war file) there typically is a META-INF folder. If it does not exist, create it and then create a new file within it called <tt>jbossws-cxf.xml</tt>. Use the following text as a template. The highlighted portions must be updated to match your operational needs.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;beans
  xmlns='http://www.springframework.org/schema/beans'
  xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
  xmlns:beans='http://www.springframework.org/schema/beans'
  xmlns:jaxws='http://cxf.apache.org/jaxws'
  xsi:schemaLocation='http://www.springframework.org/schema/beans
  http://www.springframework.org/schema/beans/spring-beans.xsd
  http://cxf.apache.org/jaxws
  http://cxf.apache.org/schemas/jaxws.xsd'&gt;

    &lt;bean id=&quot;FGSMhandler&quot; class=&quot;org.miloss.fgsms.agents.JbossWSMonitor&quot; /&gt;
  &lt;!-- one or more jaxws:endpoint EJB3 declarations --&gt;
    &lt;jaxws:endpoint
    id='DAS'
address=&quot;http://localhost:8280/DAS/dataAccessService/DAS&quot;
    implementor='org.miloss.fgsms.services.DAS4j.DAS4jBean'&gt;
        &lt;jaxws:handlers&gt;
            &lt;ref bean=&quot;FGSMhandler&quot;/&gt;
        &lt;/jaxws:handlers&gt;
        &lt;jaxws:invoker&gt;
            &lt;bean class='org.jboss.wsf.stack.cxf.InvokerEJB3'/&gt;
        &lt;/jaxws:invoker&gt;
    &lt;/jaxws:endpoint&gt;
&lt;/beans&gt;
</pre></div></div>
<h1>.NET Web Service Agents</h1></div>
<div class="section">
<h2><a name="WCF_Client_and_Service_Agent"></a>WCF Client and Service Agent</h2>
<p>Run the included FGSMS.NETInstaller.exe from the distribution package and follow the included instructions. This will setup your machine to monitor all .NET ASP.NET and WCF based capabilities. </p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">FGSMS.NETInstaller.exe installWebServiceAgentsLibraries
FGSMS.NETInstaller.exe configure 
FGSMS.NETInstaller.exe applyConfiguration
FGSMS.NETInstaller.exe addWcfExtensions
FGSMS.NETInstaller.exe enableWcfServiceMonitor
FGSMS.NETInstaller.exe enableWcfClientMonitor
</pre></div></div>
<p>The following table provides descriptions for all of the possible settings.</p>
<p>This section is for .NET based FGSMS Web Service (Transactional) Agents only.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>Property </th>
      
<th>Values </th>
      
<th>Description</th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>FGSMS.DCS.URL </td>
      
<td>url1|url2| </td>
      
<td>Execution URL to an instance of FGSMS DCS Service. Multiple values delimited by |</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.PCS.URL </td>
      
<td>url1|url2| </td>
      
<td>Execution URL to an instance of FGSMS PCS Service. Multiple values delimited by |</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.SS.URL </td>
      
<td>url1|url2| </td>
      
<td>Execution URL to an instance of FGSMS SS Service. Multiple values delimited by |</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.IgnoreList </td>
      
<td>string|string| </td>
      
<td>delimited URLs to be ignored</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.message.processor.dead.message.queue.duration </td>
      
<td>&gt;=10000 </td>
      
<td>time in milliseconds</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.AgentAuthMode </td>
      
<td>None, usernamePassword, PKI </td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.AgentAuthModeUsername </td>
      
<td>string</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.AgentAuthModePassword </td>
      
<td>Encrypted password</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.agent.dependencyinjection.enabled </td>
      
<td>true/false </td>
      
<td>Enables/Disables the insertion of headers into messages to track and correlate service chaining events.</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.agent.unavailablebehavior </td>
      
<td>PURGE, HOLD, HOLDPERSIST </td>
      
<td>PURGE= purge the queues and drop all messages until PCS/DCS is available, then resume normal operations</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.agent.persistlocation </td>
      
<td>Path to a writeable folder</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.policyconfigurationservice.algorithm </td>
      
<td>FALLBACK, ROUNDROBIN </td>
      
<td>Fallback = try the URLs in order until one works. Roundrobin = iteratively loop through the list, distributing the load evenly. If one fails, try the next one until we succeed.</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.policyconfigurationservice.retry </td>
      
<td>number &gt;= 0</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.datacollectorservice.algorithm </td>
      
<td>FALLBACK, ROUNDROBIN </td>
      
<td>Fallback = try the URLs in order until one works. Roundrobin = iteratively loop through the list, distributing the load evenly. If one fails, try the next one until we succeed.</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.datacollectorservice.retry </td>
      
<td>number &gt;= 0</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.discovery.interval </td>
      
<td>30000 </td>
      
<td>if enabled, a list of URLs will be periodically loaded and dynamically ADDED to the list of above for each service</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.discovery.uddi.enabled </td>
      
<td>true/false</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.discovery.uddi.inquiry.url </td>
      
<td>Execution URL of UDDI Inquiry</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.discovery.uddi.inquiry.authrequired </td>
      
<td>true/false</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.discovery.uddi.security.url </td>
      
<td>Execution URL of Security Inquiry</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.discovery.uddi.security.username </td>
      
<td>string</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.discovery.uddi.security.password </td>
      
<td>Encrypted password</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.discovery.uddi.lookup.findType </td>
      
<td>EndpointBindingKey, EndpointKeyWord, ServiceEntityKey </td>
      
<td>EndpointBindingKey, loads from a BindingTemplate Key, this must be the unique identifier for the binding template containing 0 or more endpoints. EndpointKeyWord, attempts to find services by name, aka the display name. ServiceEntityKey loads from a BusinessService key, this must be the unique identifier for the business service containing 0 or more binding templates with 0 or more endpoints.</td>
    </tr>
    
<tr class="a">
      
<td>FGSMS.discovery.uddi.lookup.dcs </td>
      
<td>string </td>
      
<td>Based on the findType, the value that we are looking for, see above.</td>
    </tr>
    
<tr class="b">
      
<td>FGSMS.discovery.uddi.lookup.pcs </td>
      
<td>string </td>
      
<td>Based on the findType, the value that we are looking for, see above.</td>
    </tr>
  </tbody>
</table>
<p><b>Customization Note:</b> In certain scenarios, some products or capabilities are very chatty, meaning that they execute or poll a web service very frequently. This can cause additional traffic, bandwidth and latency within your network. If you encounter this, add the offending service&#x2019;s URL to the IgnoreList (.NET only).</p></div>
<div class="section">
<h2><a name="Monitoring_a_specific_WCF_service_or_WCF_Client"></a>Monitoring a specific WCF service or WCF Client</h2>
<p>Perform the following commands using the FGSMS .NET Installer</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">FGSMS.NETInstaller.exe installWebServiceAgentsLibraries
FGSMS.NETInstaller.exe configure 
FGSMS.NETInstaller.exe applyConfiguration
FGSMS.NETInstaller.exe addWcfExtensions
</pre></div></div>
<p>Locate and merge the following settings. Consult the .NET configuration information at Microsoft&#x2019;s MSDN web site for further guidance.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">&lt;system.serviceModel&gt;
  &lt;behaviors&gt;
    &lt;endpointBehaviors&gt;			&lt;!-- for calling a service --&gt;
&lt;behavior name=&quot;clientbehavior1&quot;&gt;
		&lt;FGSMS.ClientAgent/&gt;
&lt;/behavior&gt;
    &lt;/endpointBehaviors&gt;
    &lt;serviceBehaviors&gt;
&lt;behavior name=&quot;servicebehavior1&quot;&gt;
		&lt;FGSMS.ServiceAgent/&gt;		&lt;!--  for when this service is called --&gt;
&lt;/behavior&gt;
    &lt;/serviceBehaviors&gt;
  &lt;/behaviors &gt;
</pre></div></div>
<p>This service should now be monitored.</p></div>
<div class="section">
<h2><a name="ASP.NET_Agents"></a>ASP.NET Agents</h2>
<p>To monitor all ASP.NET services and clients on a given machine Use the FGSMS.NET Installer</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">FGSMS.NETInstaller.exe installWebServiceAgentsLibraries
FGSMS.NETInstaller.exe configure 
FGSMS.NETInstaller.exe applyConfiguration
FGSMS.NETInstaller.exe enableASPMonitor
</pre></div></div>
<p>To monitor a specific ASP.NET service or client on a given machine.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">FGSMS.NETInstaller.exe installWebServiceAgentsLibraries
FGSMS.NETInstaller.exe configure 
FGSMS.NETInstaller.exe applyConfiguration
</pre></div></div>
<p>Modify the app.config or web.config file.</p>
<p>Locate the following section, it may not exist and you may have to add it.</p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">&lt;system.web&gt;
  &lt;webServices&gt;
   &lt;soapExtensionTypes&gt;
Add the following item:
     &lt;add type=&quot;FGSMS.Agent.AgentSoapExtension, FGSMS.NETAgent, Version=1.0.0.0, Culture=neutral, PublicKeyToken= e81ab410f7d48538&quot; priority=&quot;1&quot; group=&quot;High&quot;/&gt;
   &lt;/soapExtensionTypes&gt;
   &lt;/webServices&gt;
</pre></div></div></div>
<div class="section">
<h2><a name="Securing_Connection_Details"></a>Securing Connection Details</h2>
<p>Use the included utility &#x201c;FGSMS.Util.exe&#x201d; to generate encrypted text of passwords and replace the generated values with those inside of the machine.config files</p>
<p>This uses AES encryption using a 256-bit key.</p></div>
<div class="section">
<h2><a name="a.NET_Persistent_Storage_Agent"></a>.NET Persistent Storage Agent</h2>
<p>The Persistent storage agent is a daemon process that will periodically check a directory for FGSMS agent data. Data is typically only written there when an agent cannot reach the FGSMS server AND it is configured for HOLDPERSIST mode. The Persistent Storage Agent is only required for use with that configuration. Install it using the FGSMS.NET Installer. </p>

<div class="source">
<div class="source"><pre class="prettyprint linenums">FGSMS.NETInstaller.exe installWebServiceAgentsLibraries
FGSMS.NETInstaller.exe configure 
FGSMS.NETInstaller.exe applyConfiguration
FGSMS.NETInstaller.exe installPersistentWebServiceAgent
</pre></div></div>
<h1>Operating System Agents</h1>
<p>FGSMS includes some extra agents that are used exclusively for monitoring the status of machines or process.</p>
<p>See the distribution zip\agents\os Before installing or running, modify, if necessary the FGSMS.AgentCore.jar file to update URLs, usernames and passwords.</p>
<p>For Windows users, simply click on OSAgentServiceInstall.cmd and it will install and start up right away. OSAgentServiceInstallWithDEBUG.cmd may also be used for verbose logging into the same directory that the agent is located in.</p>
<h1>Statistical Agents (Message Brokers)</h1></div>
<div class="section">
<h2><a name="QpidMRG_AMQP_Message_Broker_Via_Python_Script"></a>Qpid/MRG AMQP Message Broker (Via Python Script)</h2>
<p>Dependencies:</p>

<ul>
  
<li>Access to the FGSMS Web Services Access to the locally hosted AMQP Qpid/MRG broker C++ Python</li>
</ul>
<p><b>Information Assurance Note:</b> The AMQP Message Broker agent for QPID/MRG uses a python script. Both the Java process that runs the agent and the python script must have sufficient user privileges on the system to execute.</p>
<p>Before installing or running, modify, if necessary the FGSMS.AgentCore.jar file to update URLs, usernames and passwords.</p>
<p>Execution instructions: <tt>java &#x2013;jar FGSMS.QpidPyAgent.jar</tt></p>
<p>See the included README.txt for more information.</p>
<h1>All Other Agents</h1>
<p>All other agents run on the FGSMS server and connect remotely to the component or capability. These agents are configured via the Web GUI at <a class="externalLink" href="http://localhost:8888/fgsmsBootstrap">http://localhost:8888/fgsmsBootstrap</a>.</p>
<h1>Using Active Directory to remotely install FGSMS Agents</h1>
<p>Microsoft&#x2019;s Active Directory can be used to install the following types of FGSMS Agents:</p>

<ul>
  
<li>.NET Web Service Agents (WCF, ASP.NET)</li>
  
<li>.NET Web Service Persistent Storage</li>
  
<li>Java Web Service Persistent Storage</li>
  
<li>OS Agent</li>
</ul>
<p>Note: Java Web Service agents cannot be deployed using this mechanism.</p>
<p>This is a multistep procedure that will use a Group Policy Object (GPO) to create a Software Installation Policy that will deploy the above agents. Additional steps are required. Do not just install the MSI file without reading the directions first.</p></div>
<div class="section">
<h2><a name="Overview_of_the_installation"></a>Overview of the installation</h2>

<ol style="list-style-type: decimal">
  
<li>Create an OU</li>
  
<li>Create a GPO</li>
  
<li>Define the Software Installation Policy</li>
  
<li>Define/customize a Windows Start Up Script to push the configuration</li>
  
<li>Add computers to the OU</li>
  
<li>Restart the computer (or use some other means to force the script to run)</li>
</ol>
<div class="section">
<h3><a name="Create_an_Organizational_Unit"></a>Create an Organizational Unit</h3>
<p>This step will create an Active Directory Organizational Unit to use a logical container for machines that you want to monitor. All machines within the OU will have the agents remotely installed to it.</p>
<p>TODO Pictures</p></div>
<div class="section">
<h3><a name="Create_a_Group_Policy_Object"></a>Create a Group Policy Object</h3>
<p>This step will create and assign a GPO that affects computers in the Organization Unit</p></div>
<div class="section">
<h3><a name="Define_the_Software_Installation_Policy"></a>Define the Software Installation Policy</h3>
<p>This will cause Windows to force the install of FGSM&#x2019;s agents at start up time.</p>
<p>Navigate to Computer Configuration &gt; Software Installation</p></div>
<div class="section">
<h3><a name="Definecustomize_a_Windows_Start_Up_Script_to_push_the_configuration"></a>Define/customize a Windows Start Up Script to push the configuration</h3>
<p>Navigate to Computer Configuration &gt; Windows Settings &gt; Scripts (Startup/Shutdown)</p>
<p>Click Add. Name it &#x201c;FGSMS configuration push&#x201d;. This is arbitrary. Select the script from the FGSMS distribution package in  /scripts/ updateConfigStartUpScript.bat</p>
<p>This file needs to be modified to match your environment. See inline documentation within the batch file for details.</p></div>
<div class="section">
<h3><a name="Add_Computers_to_the_Organization_Unit"></a>Add Computers to the Organization Unit</h3>
<p>The next step is to add computers to the Organization Unit. This can be done by dragging computer&#x2019;s into the new OU.</p></div>
<div class="section">
<h3><a name="Restart_the_computers"></a>Restart the computer(s)</h3>
<p>The machine now needs to be restarted. This can be performed in mass using the following command from windows. Start &gt; Run &gt; shutdown /i Administrative Credentials are required.</p></div>
<div class="section">
<h3><a name="DisablingRemoving_FGSMS_Agents"></a>Disabling/Removing FGSMS Agents</h3>
<p>There are a few different options Go to each machine that FGSMS was installed to, open Add/Remove Programs and uninstall FGSM. Remove the Software Installation Policy from Active Directory, selecting Remove Software when prompted. Disable FGSMS Agents using a script, such as net stop <tt>&lt;service name&gt;</tt> Manual Uninstall. Use this when all else fails</p></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">

        </div>
        </div>
    </footer>
    </body>
</html>
